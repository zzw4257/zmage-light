# 6. 安全、隐私与数据主权

安全与隐私是 Zmage 设计的基石，贯穿于系统的每一个角落。

*   **认证与授权**:
    *   使用 `bcryptjs` 对密码进行加盐哈希，杜绝明文存储。
    *   所有需要登录的 API 均通过 NextAuth 的 `auth()` 中间件进行会话校验。
    *   严格执行资源所有权检查，任何对数据的增删改查操作都必须匹配当前登录用户的 `userId`。
*   **分享安全**:
    *   分享链接的 `shareId` 采用加密安全的随机字节生成，具有足够的熵以防止暴力猜测。
    *   关闭分享后立即轮换新链接，使旧链接失效，最大限度降低链接泄露风险。
*   **输入安全**:
    *   所有用户输入，特别是上传的 URL，都经过严格的格式和安全验证，防止 SSRF 等攻击。
    *   文件上传对 MIME 类型和大小进行严格限制，防止恶意文件上传。