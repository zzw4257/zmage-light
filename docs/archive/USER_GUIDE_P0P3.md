# Zmage P0-P3 优化版 - 用户快速上手指南

## 🎯 这个版本做了什么

经过完整的 P0-P3 阶段，Zmage 现在是一个完整的沉浸式媒体管理系统：

### ✨ 核心亮点

#### 1. 🎬 沉浸式查看体验
- **全屏幻灯片播放**: 按 `Space` 键启动自动幻灯片
- **速度动态调节**: 按 `↑` 加快或 `↓` 减慢（1-10 秒）
- **实时滤镜应用**: 按 `F` 打开滤镜实验室
- **信息面板**: 按 `I` 查看完整的媒体信息和 AI 分析
- **键盘导航**: 支持所有常用快捷键

#### 2. 📸 智能上传流程
新的上传完成向导帮助您：
- 📊 查看上传统计（图片和视频数量）
- 📁 添加到相册或创建新相册
- 🔒 配置私密保险箱
- 🤖 启用 AI 智能分析

#### 3. 🤖 AI 视觉分析
自动为您的媒体生成：
- 📝 **智能描述**: 详细的内容描述
- 🏷️ **标签**: 自动识别的内容标签
- 🎨 **色彩分析**: 主色调识别
- 📍 **位置识别**: 自动地点识别

---

## 🚀 快速开始

### 1. 启动系统

```bash
# 前端服务（Next.js）
cd /home/zzw4257/Zmage-v2/zmage/frontend
npm run dev
# 访问: http://127.0.0.1:3001

# 后端 Worker 服务
cd /home/zzw4257/Zmage-v2/zmage/frontend
node lib/queue/worker.ts
```

### 2. 登录
- 访问 http://127.0.0.1:3001
- 使用测试账户登录

### 3. 浏览媒体库
- 进入 `/gallery` 
- 支持多种视图模式：
  - **网格**: 标准网格布局
  - **砌体**: 响应式砌体布局
  - **列表**: 列表视图
  - **彩虹**: 按色调排序

---

## 📖 核心功能使用

### 打开沉浸式查看器

**方式 1**: 点击库中的任何图片或视频
**方式 2**: 在列表中点击缩略图

### 查看器快捷键速查表

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Space` | 幻灯片 | 启动/停止自动播放 |
| `↑` | 加速 | 加快幻灯片速度 |
| `↓` | 减速 | 减慢幻灯片速度 |
| `I` | 信息面板 | 显示/隐藏媒体详情 |
| `F` | 滤镜 | 打开滤镜实验室 |
| `D` | 下载 | 下载当前媒体 |
| `S` | 分享 | 快速分享当前媒体 |
| `←` | 上一张 | 查看前一个媒体 |
| `→` | 下一张 | 查看下一个媒体 |
| `Esc` | 关闭 | 关闭查看器 |

### 信息面板标签页

**详细信息**: 文件大小、分辨率、拍摄时间、相机型号等

**备注**: 添加个人备忘录和评分

**AI 分析**: 
- 查看 AI 生成的描述
- 管理智能标签（添加/删除）
- 重新生成分析

**技术参数**:
- 曝光参数（ISO、光圈、快门等）
- 相机和镜头信息
- EXIF 数据

### 上传新媒体

**步骤 1**: 进入 `/upload`

**步骤 2**: 选择上传方式
- **单图**: 单个图片上传
- **视频**: 单个视频上传
- **文件夹**: 整个文件夹拖拽
- **ZIP 包**: 压缩包上传

**步骤 3**: 上传完成后，自动弹出向导

**步骤 4 (可选)**: 按照向导配置
- 添加到相册
- 配置 AI 分析
- 设置隐私级别

---

## 🎨 高级功能

### 滤镜实验室

在查看器中按 `F` 打开滤镜面板，可调节：
- **对比度**: 50-200%
- **饱和度**: 0-200%
- **亮度**: 50-150%
- **复古效果**: 0-100%

支持的边框样式：
- None (无边框)
- Polaroid (拍立得风格)
- Film (胶卷风格)
- Retro (复古风格)

### 相册管理

**创建相册**:
1. 进入 `/albums`
2. 点击 "新建相册"
3. 填写名称和描述
4. 选择是否为私密

**私密相册**:
- 🔒 需要密码访问
- 从库中分离显示
- 支持成员管理

### 分享媒体

**快速分享**:
1. 在查看器中按 `S` 或点击分享按钮
2. 生成分享链接
3. 复制或发送给他人

**高级分享**:
1. 进入 `/share` 管理中心
2. 点击 "新建分享"
3. 配置选项：
   - 密码保护
   - 有效期设置
   - 下载限制
   - 访问限制

---

## 🔍 搜索和过滤

### 库搜索

**快速搜索**: 库顶部的搜索框

**高级过滤**:
- 按日期范围
- 按媒体类型（图片/视频）
- 按收藏状态
- 按评分
- 按 AI 标签

### 标签系统

**AI 标签** (自动生成):
- 显示为蓝色
- 支持删除（取消 AI 分析）
- 用于搜索和过滤

**自定义标签** (手动添加):
- 显示为灰色
- 支持添加和删除
- 用于个人分类

---

## 📊 AI 分析详解

### AI 分析过程

1. **上传**: 文件上传完成
2. **处理**: 系统提取元数据
3. **分析**: AI 模型分析内容
4. **保存**: 结果存储到数据库
5. **显示**: 在信息面板中展示

### 支持的 AI 引擎

#### Google Gemini 3.0 Flash (推荐)
- ✅ 免费额度充足
- ✅ 支持中文
- ✅ 速度快（<5s）
- ✅ 精度高

#### OpenAI GPT-4o
- ✅ 高精度分析
- ✅ 多语言支持
- ⚠️ 需要付费 API
- ✅ 功能最完整

#### Anthropic Claude
- ✅ 高质量描述
- ✅ 安全合规
- ⚠️ 速度较慢
- ✅ 支持长文本

---

## ⚙️ 系统要求

### 最低配置
- CPU: 2 核
- 内存: 2GB
- 磁盘: 10GB（用于媒体存储）
- Node.js: 18+
- ffmpeg: 4.0+

### 推荐配置
- CPU: 4 核+
- 内存: 8GB+
- 磁盘: 100GB+
- Node.js: 22+
- ffmpeg: 6.0+

### 支持的文件格式

**图片** (80+ 种):
- JPEG, PNG, WebP, AVIF
- GIF, BMP, TIFF
- HEIC, HEIF (Apple)
- RAW: CR2, NEF, ARW, DNG 等
- SVG, PDF

**视频**:
- MP4, MOV, MKV
- WebM, FLV
- AVI, WMV
- HEVC/H.265

---

## 🐛 故障排除

### 问题 1: 分享链接打不开

**症状**: 访问 `/s/xxxxx` 时 404

**解决方案**:
```bash
# 确保参数被 await
const { shareId } = await params
# 检查分享链接是否过期
# 检查密码保护是否启用
```

### 问题 2: 视频没有缩略图

**症状**: 视频卡片显示黑色或加载中

**解决方案**:
```bash
# 手动生成缺失的缩略图
ffmpeg -i video.mp4 -ss 00:00:01 -vframes 1 -q:v 2 output.jpg
# 更新数据库中的 thumbnailPath
```

### 问题 3: AI 分析不工作

**症状**: 点击 "开始分析" 没有反应

**解决方案**:
1. 检查 AI API key 是否配置正确
2. 检查网络连接
3. 查看浏览器控制台错误
4. 检查 Redis 服务是否运行

### 问题 4: 幻灯片播放卡顿

**症状**: 播放时出现跳帧或延迟

**解决方案**:
1. 关闭其他标签页
2. 降低幻灯片速度（增加秒数）
3. 检查浏览器硬件加速是否启用
4. 清除浏览器缓存

---

## 💡 使用技巧

### 技巧 1: 批量管理
1. 在库中按 Ctrl/Cmd 多选
2. 右键选择批量操作
3. 一次性添加到相册或下载

### 技巧 2: 智能排序
- 按拍摄时间排序
- 按评分排序
- 按最近查看排序

### 技巧 3: 快速评分
- 在查看器中快速按数字 1-5 评分
- 在信息面板中使用星星快速评分

### 技巧 4: 键盘工作流
```
1. I 打开信息面板
2. 修改标签和备注
3. Space 启动幻灯片
4. ↑↓ 调节速度
5. Esc 关闭查看器
```

---

## 🔐 隐私和安全

### 自动隐私保护
- ✅ EXIF 数据读取选项
- ✅ 位置信息可选显示
- ✅ 私密相册密码保护
- ✅ 分享链接密码可选

### 建议的安全实践
1. 定期更改私密相册密码
2. 设置分享链接的有效期
3. 限制分享对象的访问权限
4. 定期审查分享的链接

---

## 📞 获取帮助

### 文档资源
- [完整优化总结](./OPTIMIZATION_SUMMARY.md)
- [API 文档](./docs/API.md)
- [系统架构](./docs/03_系统架构和核心原则.md)
- [Phase 2 设计规范](./docs/upgrade/phase2.md)

### 常见问题
- [快速开始指南](./docs/QUICK_START_GUIDE.md)
- [故障排除](./TROUBLESHOOTING.md)
- [部署指南](./docs/DEPLOYMENT.md)

### 联系方式
- 📧 Email: support@zmage.io
- 💬 讨论区: GitHub Discussions
- 🐛 报告问题: GitHub Issues

---

## 🎉 下一步

现在您可以：

1. ✅ **浏览媒体**: http://127.0.0.1:3001/gallery
2. ✅ **上传文件**: http://127.0.0.1:3001/upload
3. ✅ **管理相册**: http://127.0.0.1:3001/albums
4. ✅ **分享媒体**: http://127.0.0.1:3001/share
5. ✅ **查看设置**: http://127.0.0.1:3001/settings

**祝您使用愉快！** 🚀

---

**版本**: Zmage v2.0.3
**发布日期**: 2026-01-01
**状态**: ✅ 生产就绪
